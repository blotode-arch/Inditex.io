<!DOCTYPE html>
<html lang="ro">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Baptiste Lotodé | QSR Operations Simulator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root { --crimson: #990000; --anthracite: #121212; --success: #10b981; --warning: #f59e0b; }
        body { background-color: var(--anthracite); color: #f8fafc; margin: 0; overflow: hidden; font-family: 'Inter', sans-serif; }
        
        /* Glassmorphism Pro Effects */
        .glass { background: rgba(255, 255, 255, 0.03); backdrop-filter: blur(25px); border: 1px solid rgba(255, 255, 255, 0.1); }
        .glass-heavy { background: rgba(0, 0, 0, 0.6); backdrop-filter: blur(40px); border: 1px solid rgba(255, 255, 255, 0.1); }
        
        /* Fensterelemente für die Vorfälle */
        .problem-window { 
            position: absolute; width: 350px; z-index: 20; 
            animation: slideIn 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            box-shadow: 0 25px 60px rgba(0,0,0,0.8);
        }
        
        @keyframes slideIn { from { opacity: 0; transform: scale(0.9) translateY(30px); } to { opacity: 1; transform: scale(1) translateY(0); } }
        
        /* Button-Styling und Interaktionen */
        .choice-btn { transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); border: 1px solid rgba(255,255,255,0.05); position: relative; overflow: hidden; }
        .choice-btn:hover { background: rgba(255,255,255,0.05); border-color: var(--crimson); transform: translateX(8px); }
        .choice-btn::after { content: ''; position: absolute; top: 0; left: -100%; width: 100%; height: 100%; background: linear-gradient(90deg, transparent, rgba(255,255,255,0.05), transparent); transition: 0.5s; }
        .choice-btn:hover::after { left: 100%; }
        
        /* Feedback-Animationen (Erschütterung und schwebender Text) */
        @keyframes screenShake {
            0%, 100% { transform: translateX(0); }
            20%, 60% { transform: translateX(-10px); }
            40%, 80% { transform: translateX(10px); }
        }
        .shake { animation: screenShake 0.4s ease-in-out; }

        @keyframes floatText {
            0% { opacity: 0; transform: translateY(0); }
            20% { opacity: 1; }
            100% { opacity: 0; transform: translateY(-100px); }
        }
        .floating-feedback { position: fixed; pointer-events: none; z-index: 100; font-weight: 900; font-style: italic; animation: floatText 1s ease-out forwards; }

        .text-outline { -webkit-text-stroke: 1px rgba(255, 255, 255, 0.05); color: transparent; }

        @keyframes timerBar { from { width: 100%; } to { width: 0%; } }

        /* CRT-Scanline-Effekt für Monitor-Optik */
        .scanline { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.1) 50%), linear-gradient(90deg, rgba(255, 0, 0, 0.02), rgba(0, 255, 0, 0.01), rgba(0, 0, 255, 0.02)); background-size: 100% 2px, 3px 100%; pointer-events: none; z-index: 50; }
    </style>
</head>
<body class="flex flex-col min-h-screen" id="main-body">

    <div class="scanline"></div>

    <!-- Audio-Elemente -->
    <audio id="snd-spawn" src="https://assets.mixkit.co/active_storage/sfx/2869/2869-preview.mp3"></audio>
    <audio id="snd-correct" src="https://assets.mixkit.co/active_storage/sfx/2000/2000-preview.mp3"></audio>
    <audio id="snd-wrong" src="https://assets.mixkit.co/active_storage/sfx/959/959-preview.mp3"></audio>

    <nav class="fixed w-full z-50 py-6 px-10 bg-black/60 backdrop-blur-xl border-b border-white/5">
        <div class="max-w-7xl mx-auto flex justify-between items-center text-[10px] font-bold uppercase tracking-[0.3em]">
            <a href="index.html" class="text-2xl font-black tracking-tighter uppercase">Baptiste <span class="text-red-700">Lotodé</span></a>
            <div class="hidden md:flex space-x-10 items-center">
                <a href="management.html" class="hover:text-red-700 transition">Management</a>
                <a href="operations.html" class="hover:text-red-700 transition">Operations</a>
                <a href="tech.html" class="hover:text-red-700 transition">Inovație</a>
                <a href="game.html" class="hover:text-red-700 transition text-red-500 italic">Ops Challenge</a>
                <a href="contact.html" class="bg-red-700 text-white px-6 py-2 rounded-full hover:bg-white hover:text-red-700 transition">Contact</a>
            </div>
        </div>
    </nav>

    <main class="flex-grow pt-32 flex flex-col items-center relative px-4 overflow-hidden">
        <div class="absolute top-60 left-1/2 -translate-x-1/2 text-[10rem] md:text-[15rem] font-black text-outline uppercase select-none pointer-events-none z-0">Eficiență</div>

        <!-- Dashboard-Oberfläche -->
        <div class="w-full max-w-5xl glass-heavy rounded-[3rem] p-10 mb-6 flex flex-wrap justify-between items-center z-10 border-t border-white/10 shadow-2xl">
            <div class="flex flex-col w-full md:w-1/3 mb-4 md:mb-0">
                <div class="flex justify-between items-end mb-2">
                    <span class="text-[10px] uppercase font-bold text-gray-500 tracking-[0.2em]">SLA Performanță Restaurant</span>
                    <span id="sla-percent" class="text-[10px] font-black text-white">100%</span>
                </div>
                <div class="w-full h-3 bg-gray-900 rounded-full overflow-hidden border border-white/5 p-[2px]">
                    <div id="sla-bar" class="h-full bg-gradient-to-r from-emerald-600 to-emerald-400 transition-all duration-500 rounded-full shadow-[0_0_15px_rgba(16,185,129,0.3)]" style="width: 100%;"></div>
                </div>
            </div>
            <div class="text-center">
                <span class="text-[10px] uppercase font-bold text-gray-500 tracking-[0.2em]">Timp Schimb</span>
                <div id="global-timer" class="text-5xl font-black italic tracking-tighter text-white">60s</div>
            </div>
            <div class="text-right">
                <span class="text-[10px] uppercase font-bold text-gray-500 tracking-[0.2em]">Scor Eficiență</span>
                <div id="score-display" class="text-5xl font-black text-red-700 drop-shadow-lg">0</div>
            </div>
        </div>

        <div id="game-canvas" class="w-full max-w-6xl h-[550px] relative z-10 overflow-hidden rounded-[4rem]">
            <div id="start-screen" class="absolute inset-0 flex items-center justify-center">
                <div class="glass p-16 rounded-[4rem] text-center max-w-2xl border border-white/10 shadow-2xl">
                    <div class="w-24 h-24 bg-red-700/20 rounded-full flex items-center justify-center mx-auto mb-8 animate-pulse">
                        <i class="fas fa-bolt text-red-700 text-4xl"></i>
                    </div>
                    <h2 class="text-5xl font-black uppercase italic mb-6 tracking-tighter">QSR Shift Simulator</h2>
                    
                    <div class="text-left space-y-4 mb-10 text-gray-400 text-sm">
                        <p class="flex items-center"><i class="fas fa-bolt text-red-700 mr-3"></i> <strong>Misiune:</strong> Gestionează incidentele critice dintr-o bucătărie sub presiune.</p>
                        <p class="flex items-center"><i class="fas fa-check-circle text-red-700 mr-3"></i> <strong>Sistem:</strong> 30 de scenarii reale bazate pe experiența din System Gastronomy.</p>
                        <p class="flex items-center text-white"><i class="fas fa-layer-group text-red-700 mr-3"></i> <strong>Realism:</strong> Problemele pot apărea simultan pentru a simula multitasking-ul, dar nu se vor suprapune vizual.</p>
                        <p class="flex items-center"><i class="fas fa-brain text-red-700 mr-3"></i> <strong>Prioritizare:</strong> Alege ce problemă rezolvi prima dată înainte ca timpul să expire!</p>
                    </div>

                    <button onclick="initGame()" class="group relative bg-white text-black px-20 py-7 rounded-2xl font-black uppercase text-xs hover:bg-red-700 hover:text-white transition-all tracking-widest overflow-hidden">
                        <span class="relative z-10">Începe Schimbul</span>
                        <div class="absolute inset-0 bg-red-700 transform scale-x-0 group-hover:scale-x-100 transition-transform origin-left"></div>
                    </button>
                </div>
            </div>
        </div>
    </main>

    <footer class="py-10 text-center text-gray-700 text-[10px] font-bold uppercase tracking-[0.5em]">
        Baptiste Lotodé • Cluj-Napoca • Operations Mastery 2026
    </footer>

    <script>
        let sla = 100, score = 0, timeLeft = 60, gameActive = false;
        let activeIntervals = [];
        let lastFiveIds = [];

        // Umfangreiche Aufgabenliste (30 Szenarien)
        const problems = [
            { id: 1, title: "Drive-Thru Blocat", text: "Coada de mașini depășește 10 minute.", options: ["Deschide a doua fereastră", "Ignoră și continuă lobby", "Cere clienților să aștepte"], correct: 0, points: 20 },
            { id: 2, title: "Friteuză Defectă", text: "Friteuza principală s-a oprit în vârf de prânz.", options: ["Cheamă mentenanța & Ajustează meniul", "Închide restaurantul", "Folosește friteuza de rezervă mică"], correct: 0, points: 25 },
            { id: 3, title: "Lipsă Chifle Burger", text: "Stocul de chifle este aproape de zero.", options: ["Împrumut de la restaurantul vecin", "Scoate burgerii din meniu", "Așteaptă livrarea de mâine"], correct: 0, points: 20 },
            { id: 4, title: "Alertă HACCP", text: "Temperatura la vitrina frigorifică este de 8°C.", options: ["Transferă produsele & Verifică tehnic", "Lasă produsele acolo", "Închide vitrina fără transfer"], correct: 0, points: 30 },
            { id: 5, title: "Plângere Client", text: "Clientul reclamă cartofi prăjiți reci.", options: ["Înlocuiește imediat & Scuze", "Spune că sunt proaspeți", "Oferă doar banii înapoi"], correct: 0, points: 15 },
            { id: 6, title: "Echipă Incompletă", text: "Doi angajați au întârziat la schimbul de prânz.", options: ["Cross-training: Re-alocă echipa", "Închide Drive-Thru", "Lucrează singur pe toate zonele"], correct: 0, points: 25 },
            { id: 7, title: "Lobby Murdar", text: "S-a vărsat o băutură pe coridorul principal.", options: ["Securizezi zona & Curăță imediat", "Așteaptă firma de curățenie", "Pune doar un semn galben"], correct: 0, points: 20 },
            { id: 8, title: "Livrare Întârziată", text: "Camionul cu marfă proaspătă întârzie 2 ore.", options: ["Verifică stocul de siguranță", "Anulează toate comenzile", "Trimite angajații acasă"], correct: 0, points: 20 },
            { id: 9, title: "Control Pierderi", text: "Nivelul de 'Waste' la bin este prea mare.", options: ["Verifică timpii de gătire (hold)", "Nu mai găti deloc", "Aruncă totul la gunoi ascuns"], correct: 0, points: 25 },
            { id: 10, title: "Vârf de Prânz", text: "Aflux masiv de clienți neașteptat.", options: ["Toți la posturi (All Hands)", "Ia pauză acum", "Servește doar clienții VIP"], correct: 0, points: 15 },
            { id: 11, title: "Sistem Plată Defect", text: "Terminalele de card nu funcționează.", options: ["Anunță clienții imediat & IT", "Spune-le la final", "Închide restaurantul"], correct: 0, points: 25 },
            { id: 12, title: "Control DSP", text: "Inspecție inopinată de la DSP.", options: ["Însoțește inspectorul & Transparență", "Spune că managerul lipsește", "Refuză accesul"], correct: 0, points: 30 },
            { id: 13, title: "Ulei Uzat", text: "Nivel critic de compuși polari în ulei.", options: ["Schimbă uleiul imediat", "Mai folosește-l o tură", "Adaugă ulei proaspăt"], correct: 0, points: 25 },
            { id: 14, title: "Conflict Echipă", text: "Ceartă între stații în vârf de rush.", options: ["Mediere scurtă & Focus pe rush", "Ignoră conflictul", "Trimite-i acasă"], correct: 0, points: 20 },
            { id: 15, title: "Eroare Kiosk", text: "Comandă plătită dar nu apare pe ecran.", options: ["Verifică bonul & Prepară manual", "Pune clientul să comande iar", "Suport tehnic"], correct: 0, points: 20 },
            { id: 16, title: "Sos Expirat", text: "S-a găsit sos expirat ieri la dressier.", options: ["Elimină imediat & Re-train FIFO", "Folosește până la capăt", "Pune-l în spate"], correct: 0, points: 30 },
            { id: 17, title: "Toalete Murdare", text: "Clienții se plâng de starea toaletelor.", options: ["Delegă curățenia imediat", "Așteaptă tura următoare", "Închide toaletele"], correct: 0, points: 15 },
            { id: 18, title: "Pană Curent Băuturi", text: "Zona de băuturi nu are curent.", options: ["Siguranțe & Oferă alternative", "Nu mai vinde băuturi", "Așteaptă electricianul"], correct: 0, points: 20 },
            { id: 19, title: "Livrare Incompletă", text: "LKW-ul a adus carne dar lipsesc cartofii.", options: ["Verifică stoc & Împrumut urgență", "Nu mai vinde cartofi", "Închide Drive-Thru"], correct: 0, points: 25 },
            { id: 20, title: "Lobby rece", text: "AC-ul răcește prea tare, clienții se plâng.", options: ["Ajustează termostatul (22-24°C)", "Oprește sistemul", "Ignoră"], correct: 0, points: 15 },
            { id: 21, title: "Alarmă Incendiu", text: "Senzor activat de fum la Grill.", options: ["Evacuează & Aplică protocol", "Oprește doar Grill-ul", "Ignoră"], correct: 0, points: 35 },
            { id: 22, title: "Angajat Bolnav", text: "Angajatul este palid și are grețuri.", options: ["Trimite acasă & Igienizează", "Poartă mască", "Mută la Drive-Thru"], correct: 0, points: 30 },
            { id: 23, title: "Eroare Livrări", text: "Tableta de comenzi online este defectă.", options: ["Sună suport & Manager App", "Nu mai accepta comenzi", "Închide livrările"], correct: 0, points: 25 },
            { id: 24, title: "Accident Ulei", text: "Ulei s-a vărsat lângă friteuze.", options: ["Degresează imediat & Securizează", "Pune cartoane", "Așteaptă răcirea"], correct: 0, points: 30 },
            { id: 25, title: "Lansare Produs", text: "Fără materiale publicitare la lansare.", options: ["Upsell verbal prin echipă", "Nu vinde produsul", "Anulează campania"], correct: 0, points: 20 },
            { id: 26, title: "Ușă Congelator", text: "Ușa a stat deschisă 1 oră.", options: ["Verifică temperatură & Stoc", "Închide și taci", "Aruncă tot stocul"], correct: 0, points: 25 },
            { id: 27, title: "Client Filmează", text: "Client filmează agresiv în bucătărie.", options: ["Abordează politicos & GDPR", "Smulge telefonul", "Sună la poliție"], correct: 0, points: 20 },
            { id: 28, title: "Bancnotă Suspectă", text: "Diferență la tester pentru 100 RON.", options: ["Refuză politicos & Supervisor", "Reține bancnota", "Acceptă-o"], correct: 0, points: 25 },
            { id: 29, title: "Diferență Inventar", text: "Lipsesc 20 kg de carne la final de zi.", options: ["Re-numără & Verifică Waste Log", "Scade din salariu", "Manual manual"], correct: 0, points: 30 },
            { id: 30, title: "Client Agresiv", text: "Client țipă din cauza unei erori de meniu.", options: ["Dialog calm în privat", "Țipă înapoi", "Ignoră-l"], correct: 0, points: 25 }
        ];

        function playSnd(id) { 
            const s = document.getElementById(id);
            if(s) { s.currentTime = 0; s.play().catch(() => {}); }
        }

        function createFloatingText(text, color, x, y) {
            const el = document.createElement('div');
            el.className = 'floating-feedback';
            el.style.left = x + 'px';
            el.style.top = y + 'px';
            el.style.color = color;
            el.innerText = text;
            document.body.appendChild(el);
            setTimeout(() => el.remove(), 1000);
        }

        function initGame() {
            gameActive = true; sla = 100; score = 0; timeLeft = 60; lastFiveIds = [];
            document.getElementById('start-screen').classList.add('hidden');
            document.getElementById('game-canvas').innerHTML = ""; 
            
            const timerInterval = setInterval(() => {
                timeLeft--; 
                document.getElementById('global-timer').innerText = timeLeft + "s";
                if (timeLeft <= 0 || sla <= 0) stopGame(timeLeft <= 0 ? "Schimb finalizat cu succes!" : "Schimb eșuat!");
            }, 1000);
            
            const decayInterval = setInterval(() => { 
                if(gameActive) {
                    sla -= 0.65; 
                    updateUI();
                }
            }, 1000);

            const spawnInterval = setInterval(spawnProblem, 4500);
            
            activeIntervals.push(timerInterval, decayInterval, spawnInterval);
            spawnProblem();
        }

        // Hilfsfunktion zur Kollisionsprüfung
        function isOverlapping(newX, newY, newW, newH) {
            const windows = document.querySelectorAll('.problem-window');
            for (let win of windows) {
                const rect = {
                    x: parseInt(win.style.left),
                    y: parseInt(win.style.top),
                    w: 350,
                    h: 320 // Geschätzte Höhe inkl. Padding
                };
                
                // Rechteck-Kollision mit kleinem Puffer
                if (newX < rect.x + rect.w + 20 &&
                    newX + newW + 20 > rect.x &&
                    newY < rect.y + rect.h + 20 &&
                    newY + newH + 20 > rect.y) {
                    return true;
                }
            }
            return false;
        }

        function spawnProblem() {
            if (!gameActive) return;

            const canvas = document.getElementById('game-canvas');
            const canvasWidth = canvas.clientWidth;
            const canvasHeight = canvas.clientHeight;
            const winW = 350;
            const winH = 320;

            let finalX = 0, finalY = 0;
            let foundSpot = false;
            let attempts = 0;

            // Suche nach einem freien Platz (maximal 15 Versuche)
            while (!foundSpot && attempts < 15) {
                finalX = Math.random() * (canvasWidth - winW - 20) + 10;
                finalY = Math.random() * (canvasHeight - winH - 20) + 10;
                
                if (!isOverlapping(finalX, finalY, winW, winH)) {
                    foundSpot = true;
                }
                attempts++;
            }

            // Wenn nach 15 Versuchen kein Platz frei ist, überspringen wir diesen Spawn, 
            // um das Interface nicht zu blockieren.
            if (!foundSpot) return;

            playSnd('snd-spawn');

            let availableProblems = problems.filter(p => !lastFiveIds.includes(p.id));
            if (availableProblems.length === 0) {
                lastFiveIds = [];
                availableProblems = problems;
            }

            const problem = availableProblems[Math.floor(Math.random() * availableProblems.length)];
            lastFiveIds.push(problem.id);
            if (lastFiveIds.length > 5) lastFiveIds.shift();

            const shuffledIndices = problem.options.map((_, i) => i).sort(() => Math.random() - 0.5);

            const div = document.createElement('div');
            div.className = 'problem-window glass-heavy p-8 rounded-[2.5rem] border-l-4 border-red-700 shadow-2xl';
            div.style.left = `${finalX}px`;
            div.style.top = `${finalY}px`;

            let timeLimit = Math.max(3500, 9500 - (score * 20)); 

            div.innerHTML = `
                <div class="flex justify-between items-start mb-4">
                    <h3 class="font-black uppercase italic text-xs tracking-[0.2em] text-white">${problem.title}</h3>
                    <span class="text-[9px] bg-red-700 px-3 py-1 rounded-full font-black text-white">+${problem.points} PTS</span>
                </div>
                <p class="text-[11px] text-gray-400 mb-8 font-bold leading-snug">${problem.text}</p>
                <div class="space-y-3">
                    ${shuffledIndices.map(idx => `
                        <button onclick="checkAnswer(this, ${idx === problem.correct}, ${problem.points}, event)" 
                                class="choice-btn w-full text-left p-4 rounded-2xl bg-white/5 text-[9px] font-black uppercase tracking-tight text-gray-300">
                            ${problem.options[idx]}
                        </button>
                    `).join('')}
                </div>
                <div class="mt-6 h-1 bg-white/5 rounded-full overflow-hidden">
                    <div class="h-full bg-red-700" style="animation: timerBar ${timeLimit}ms linear forwards"></div>
                </div>
            `;

            canvas.appendChild(div);

            const timeout = setTimeout(() => {
                if (div.parentNode) {
                    div.remove();
                    updateHealth(-20, null);
                }
            }, timeLimit);

            activeIntervals.push(timeout);
        }

        function checkAnswer(btn, isCorrect, points, event) {
            if (!gameActive) return;
            const win = btn.closest('.problem-window');
            const x = event.clientX;
            const y = event.clientY;
            
            if (isCorrect) {
                playSnd('snd-correct');
                score += points;
                sla = Math.min(100, sla + 8);
                createFloatingText('+' + points, '#10b981', x, y);
            } else {
                playSnd('snd-wrong');
                updateHealth(-25, {x, y});
                document.getElementById('main-body').classList.add('shake');
                setTimeout(() => document.getElementById('main-body').classList.remove('shake'), 400);
            }
            
            if(win) win.remove();
            updateUI();
        }

        function updateHealth(val, coords) {
            sla += val;
            if (sla < 0) sla = 0;
            if (coords) createFloatingText(val, '#ef4444', coords.x, coords.y);
            updateUI();
        }

        function updateUI() {
            const bar = document.getElementById('sla-bar');
            const percent = document.getElementById('sla-percent');
            if (bar) {
                bar.style.width = sla + "%";
                if (sla > 70) {
                    bar.style.background = 'linear-gradient(90deg, #059669, #10b981)';
                    bar.style.boxShadow = '0 0 15px rgba(16,185,129,0.3)';
                } else if (sla > 30) {
                    bar.style.background = 'linear-gradient(90deg, #d97706, #f59e0b)';
                    bar.style.boxShadow = '0 0 15px rgba(245,158,11,0.3)';
                } else {
                    bar.style.background = 'linear-gradient(90deg, #990000, #ef4444)';
                    bar.style.boxShadow = '0 0 15px rgba(239,68,68,0.5)';
                }
            }
            if (percent) percent.innerText = Math.round(sla) + "%";
            const scoreDisp = document.getElementById('score-display');
            if (scoreDisp) scoreDisp.innerText = score;
        }

        function stopGame(msg) {
            gameActive = false;
            activeIntervals.forEach(clearInterval); 
            activeIntervals.forEach(clearTimeout);

            let rank = "";
            let color = "text-white";

            if (score >= 450) { rank = "Expert Strategie QSR"; color = "text-emerald-500"; }
            else if (score >= 250) { rank = "Supervizor Schimb"; color = "text-white"; }
            else if (score >= 100) { rank = "Junior Manager"; color = "text-gray-400"; }
            else { rank = "Ești Concediat!"; color = "text-red-600 animate-pulse"; }

            document.getElementById('game-canvas').innerHTML = `
                <div class="absolute inset-0 flex items-center justify-center">
                    <div class="glass-heavy p-20 rounded-[4rem] text-center border-2 border-red-700/30 shadow-2xl max-w-lg">
                        <h2 class="text-6xl font-black uppercase italic mb-6 ${color} tracking-tighter">${rank}</h2>
                        <p class="text-gray-400 mb-12 font-bold uppercase tracking-widest text-sm leading-relaxed">${msg}<br>Scor Final: ${score}</p>
                        <button onclick="location.reload()" class="bg-white text-black px-16 py-6 rounded-2xl font-black uppercase text-xs hover:bg-red-700 hover:text-white transition-all tracking-widest">Reîncepe Schimbul</button>
                    </div>
                </div>
            `;
        }
    </script>
</body>
</html>